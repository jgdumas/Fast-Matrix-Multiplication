function C = DPS48o_4_4_4(A, B, nmin, peeling, level)
if nargin < 3, nmin = 4; end    % Threshold to conventional
if nargin < 4, peeling = 1; end % Static (1) or Dynamic (2) peeling
if nargin < 5, level = 8; end   % Verbose level
[m,k] = size(A); [k2,n] = size(B);
if (k2 ~= k), error('Incompatible matrix dimensions.'); end
% Recursively cuts into nmin*4^l x nmin*4^l x nmin*4^l blocks, with decreasing maximal l
if (m<=nmin)||(k<=nmin)||(n<=nmin)||(m<4)||(k<4)||(n<4)
  % fprintf("# MM Direct: %d x %d x %d\n",m,k,n)
  C = A*B;
else
  C = zeros(m,n);
  mu=m-rem(m,4);ku=k-rem(k,4);nu=n-rem(n,4);
  l=ceil(min([log(mu)/log(4),log(ku)/log(4),log(nu)/log(4)]));
  if (peeling == 1)
    l = min([floor(log(m/nmin)/log(4)),floor(log(k/nmin)/log(4)),floor(log(n/nmin)/log(4))]);
    mu=nmin*4^l; ku=nmin*4^l; nu=nmin*4^l;
  end
  if (mu < m) || (ku < k) || (nu < n)
    % fprintf("# Core SubMatrix[%d]: %d x %d x %d\n",l,mu,ku,nu)
    C(1:mu,1:nu)=DPS48o_4_4_4(A(1:mu,1:ku),B(1:ku,1:nu),nmin, peeling, level);
    if (m > mu)
      % fprintf("# MM peel m: %d x %d x %d\n",m-mu,k,n)
      C(mu+1:m,1:n)=C(mu+1:m,1:n)+DPS48o(A(mu+1:m,1:k),B,nmin, peeling, level);
    end
    if (k > ku) && (mu > 0) && (nu > 0)
      % fprintf("# MM peel k: %d x %d x %d\n",mu,k-ku,nu)
      C(1:mu,1:nu)=C(1:mu,1:nu)+DPS48o(A(1:mu,ku+1:k),B(ku+1:k,1:nu),nmin, peeling, level);
    end
    if (n > nu) && (mu > 0)
      % fprintf("# MM peel n: %d x %d x %d\n",mu,k,n-nu)
      C(1:mu,nu+1:n)=C(1:mu,nu+1:n)+DPS48o(A(1:mu,1:k),B(1:k,nu+1:n),nmin, peeling, level);
    end
  else
    if l>=level, fprintf("# Core<4;4;4>[%d]: %d x %d x %d\n",l,m,k,n); end

[m,n] = size(A);
m0 = 0; m1 = 1*m/4; m2 = 2*m/4; m3 = 3*m/4; m4 = m;
 r0 = m0+1:m1; r1 = m1+1:m2; r2 = m2+1:m3; r3 = m3+1:m4;
n0 = 0; n1 = 1*n/4; n2 = 2*n/4; n3 = 3*n/4; n4 = n;
 c0 = n0+1:n1; c1 = n1+1:n2; c2 = n2+1:n3; c3 = n3+1:n4;
t16 = A(r0,c2)+A(r2,c0);
t17 = A(r0,c3)+A(r3,c0);
t18 = A(r1,c2)+A(r2,c1);
t19 = A(r1,c3)-A(r3,c1);
t20 = A(r0,c1)+A(r2,c3);
t21 = A(r1,c0)-A(r3,c2);
t22 = A(r0,c0)+A(r3,c3);
t23 = A(r1,c0)+A(r3,c2);
t24 = A(r0,c1)-A(r2,c3);
t25 = A(r1,c1)+A(r2,c2);
t26 = t17-t18;
t27 = t16-t19;
t28 = t16+t19;
t29 = t17+t18;
t30 = t22+t25;
t31 = A(r0,c3)-A(r3,c0);
t33 = A(r1,c2)-A(r2,c1);
t34 = A(r1,c1)-A(r2,c2)-t22;
t35 = t25-t22;
t37 = A(r1,c3)+A(r3,c1);
t38 = A(r0,c2)-A(r2,c0);
t39 = A(r0,c0)-A(r3,c3)+t25;
t40 = t21+t24;
t41 = t29-t23;
t42 = t21-t24;
t43 = t23+t29;
t44 = t23-t24;
t45 = t23+t24;
t46 = t20+t21;
t47 = t20-t21;
t48 = t16+t30;
t49 = t17+t34;
t50 = t31+t39;
t51 = t17-t34;
t52 = t35+t38;
t53 = t16-t30;
t54 = t35-t38;
t55 = t39-t31;
oA41 = t45-t27;
oA45 = t42-t26;
oA40 = t40-t26;
oA47 = t28+t46;
oA33 = t20-t43;
oA37 = t28-t44;
oA35 = t27-t47;
oA42 = t41-t20;
oA44 = t27+t47;
oA39 = t26+t40;
oA32 = t26+t42;
oA43 = t20+t41;
oA46 = t46-t28;
oA36 = t20+t43;
oA38 = t28+t44;
oA34 = t27+t45;
t72 = t55-t18;
t73 = t37+t53;
t74 = t18-t50;
t75 = t19-t54;
t76 = t37-t53;
t77 = t37+t48;
t78 = t33+t49;
t79 = t33+t51;
t80 = t19-t52;
t81 = t33-t51;
t82 = t19+t54;
t83 = t33-t49;
t84 = t55+t18;
t85 = t19+t52;
t86 = t18+t50;
t87 = t37-t48;
oA0 = t87-oA40;
oA1 = t82-oA45;
oA2 = t83-oA35;
oA3 = oA39+t76;
oA4 = oA37+t78;
oA5 = t86-oA47;
oA6 = oA38-t79;
oA7 = t72-oA46;
oA8 = t74-oA41;
oA9 = oA46+t72;
oA10 = oA32-t80;
oA11 = oA34-t84;
oA12 = oA37-t78;
oA13 = t74+oA41;
oA14 = t73+oA42;
oA15 = oA44+t81;
oA16 = t75-oA33;
oA17 = oA40+t87;
oA18 = oA36+t77;
oA19 = oA33+t75;
oA20 = oA32+t80;
oA21 = t82+oA45;
oA22 = oA39-t76;
oA23 = oA38+t79;
oA24 = oA44-t81;
oA25 = oA47+t86;
oA26 = oA34+t84;
oA27 = oA42-t73;
oA28 = oA35+t83;
oA29 = oA43+t85;
oA30 = oA43-t85;
oA31 = t77-oA36;

[m,n] = size(B);
m0 = 0; m1 = 1*m/4; m2 = 2*m/4; m3 = 3*m/4; m4 = m;
 r0 = m0+1:m1; r1 = m1+1:m2; r2 = m2+1:m3; r3 = m3+1:m4;
n0 = 0; n1 = 1*n/4; n2 = 2*n/4; n3 = 3*n/4; n4 = n;
 c0 = n0+1:n1; c1 = n1+1:n2; c2 = n2+1:n3; c3 = n3+1:n4;
t16 = B(r1,c3)+B(r2,c3);
t17 = B(r0,c2)-B(r3,c2);
t18 = B(r0,c3)-B(r3,c3);
t19 = B(r1,c2)-B(r2,c2);
t20 = B(r0,c2)+B(r3,c2);
t21 = B(r0,c1)-B(r3,c1);
t22 = B(r0,c0)+B(r3,c0);
t23 = B(r0,c0)-B(r3,c0);
t24 = B(r1,c1)+B(r2,c1);
t25 = B(r0,c1)+B(r3,c1);
t26 = B(r1,c2)+B(r2,c2);
t27 = B(r1,c3)-B(r2,c3);
t28 = B(r1,c0)-B(r2,c0);
t29 = B(r0,c3)+B(r3,c3);
t30 = B(r1,c0)+B(r2,c0);
t31 = B(r2,c1)-B(r1,c1);
oB2 = t19-t28;
oB4 = t16+t30;
oB5 = t22-t20;
oB6 = t27+t31;
oB7 = t17+t23;
oB8 = t22+t29;
oB9 = t21-t17;
oB11 = t21-t18;
oB12 = t16+t24;
oB13 = t25+t29;
oB15 = t26-t24;
oB23 = t28-t27;
oB24 = t26+t30;
oB25 = t20+t25;
oB26 = t18-t23;
oB28 = t31-t19;
v48 = oB12-oB26;
v49 = oB24-oB25;
v50 = oB2+oB9;
v51 = oB4-oB11;
v52 = oB5-oB15;
v53 = oB7-oB28;
v54 = oB13-oB23;
v55 = oB8-oB6;
oB43 = v49-v53;
oB39 = v52-v50;
oB33 = v50+v52;
oB42 = v51-v55;
oB32 = v54-v48;
oB36 = v48+v54;
oB40 = v49+v53;
oB45 = v51+v55;
g80 = oB43/2;
g81 = oB39/2;
g82 = oB33/2;
g83 = oB42/2;
g84 = oB32/2;
g85 = oB36/2;
g86 = oB40/2;
g87 = oB45/2;
g88 = (v55-oB13-oB23)/2;
g89 = (oB2-v53-oB9)/2;
g90 = (oB5+oB15-v49)/2;
g91 = (oB6+oB8-v54)/2;
g92 = (oB25+v52+oB24)/2;
g93 = (oB11+oB4-v48)/2;
g94 = (oB12+oB26-v51)/2;
g95 = (v50+oB7+oB28)/2;
oB41 = v54+v55;
oB44 = v52-v49;
oB47 = v49+v52;
oB37 = v48+v51;
oB20 = g90-g84;
oB27 = g83+g90;
oB14 = g89-g83;
oB10 = g89-g84;
oB1 = g87+g95;
oB31 = g85-g95;
oB38 = v55-v54;
oB17 = g88-g86;
oB19 = g94-g82;
oB46 = v53-v50;
oB29 = g93-g80;
oB22 = g93+g81;
oB34 = v48-v51;
oB18 = g92-g85;
oB0 = g94+g86;
oB30 = g91-g80;
oB3 = g91-g81;
oB16 = g82-g88;
oB35 = v50+v53;
oB21 = g92-g87;

iC0 = DPS48o( oA0, oB0, nmin, peeling, level);
iC1 = DPS48o( oA1, oB1, nmin, peeling, level);
iC2 = DPS48o( oA2, oB2, nmin, peeling, level);
iC3 = DPS48o( oA3, oB3, nmin, peeling, level);
iC4 = DPS48o( oA4, oB4, nmin, peeling, level);
iC5 = DPS48o( oA5, oB5, nmin, peeling, level);
iC6 = DPS48o( oA6, oB6, nmin, peeling, level);
iC7 = DPS48o( oA7, oB7, nmin, peeling, level);
iC8 = DPS48o( oA8, oB8, nmin, peeling, level);
iC9 = DPS48o( oA9, oB9, nmin, peeling, level);
iC10 = DPS48o( oA10, oB10, nmin, peeling, level);
iC11 = DPS48o( oA11, oB11, nmin, peeling, level);
iC12 = DPS48o( oA12, oB12, nmin, peeling, level);
iC13 = DPS48o( oA13, oB13, nmin, peeling, level);
iC14 = DPS48o( oA14, oB14, nmin, peeling, level);
iC15 = DPS48o( oA15, oB15, nmin, peeling, level);
iC16 = DPS48o( oA16, oB16, nmin, peeling, level);
iC17 = DPS48o( oA17, oB17, nmin, peeling, level);
iC18 = DPS48o( oA18, oB18, nmin, peeling, level);
iC19 = DPS48o( oA19, oB19, nmin, peeling, level);
iC20 = DPS48o( oA20, oB20, nmin, peeling, level);
iC21 = DPS48o( oA21, oB21, nmin, peeling, level);
iC22 = DPS48o( oA22, oB22, nmin, peeling, level);
iC23 = DPS48o( oA23, oB23, nmin, peeling, level);
iC24 = DPS48o( oA24, oB24, nmin, peeling, level);
iC25 = DPS48o( oA25, oB25, nmin, peeling, level);
iC26 = DPS48o( oA26, oB26, nmin, peeling, level);
iC27 = DPS48o( oA27, oB27, nmin, peeling, level);
iC28 = DPS48o( oA28, oB28, nmin, peeling, level);
iC29 = DPS48o( oA29, oB29, nmin, peeling, level);
iC30 = DPS48o( oA30, oB30, nmin, peeling, level);
iC31 = DPS48o( oA31, oB31, nmin, peeling, level);
iC32 = DPS48o( oA32, oB32, nmin, peeling, level);
iC33 = DPS48o( oA33, oB33, nmin, peeling, level);
iC34 = DPS48o( oA34, oB34, nmin, peeling, level);
iC35 = DPS48o( oA35, oB35, nmin, peeling, level);
iC36 = DPS48o( oA36, oB36, nmin, peeling, level);
iC37 = DPS48o( oA37, oB37, nmin, peeling, level);
iC38 = DPS48o( oA38, oB38, nmin, peeling, level);
iC39 = DPS48o( oA39, oB39, nmin, peeling, level);
iC40 = DPS48o( oA40, oB40, nmin, peeling, level);
iC41 = DPS48o( oA41, oB41, nmin, peeling, level);
iC42 = DPS48o( oA42, oB42, nmin, peeling, level);
iC43 = DPS48o( oA43, oB43, nmin, peeling, level);
iC44 = DPS48o( oA44, oB44, nmin, peeling, level);
iC45 = DPS48o( oA45, oB45, nmin, peeling, level);
iC46 = DPS48o( oA46, oB46, nmin, peeling, level);
iC47 = DPS48o( oA47, oB47, nmin, peeling, level);

b1 = iC26+iC23;
v64 = iC24+iC7;
b4 = iC6-iC11;
b5 = iC38-iC23+iC6;
v68 = iC13-iC12;
b6 = iC7+iC46+iC9;
b7 = iC24+iC44+iC15;
b8 = iC3-iC9+iC15;
b9 = iC41-iC13+iC8;
b10 = iC2-iC5;
b11 = iC35+iC28+iC2;
b12 = iC11-iC26-iC34;
b13 = iC25+iC28;
b14 = iC47+iC5+iC25;
v67 = iC8-iC4;
b24 = v64-b13-iC43;
b30 = b14-iC18*2+b7;
b34 = iC17*2-b9+b5;
b36 = iC14*2-b6+b11;
v54 = iC0+b24;
b37 = iC22-iC17-b12+v54;
v48 = iC36+(b11+b6-b30)/2;
b43 = (b7-b14-b36)/2-iC42;
z45 = iC45+iC42-v67+b4+b36;
z40 = iC40+b34-b24;
z39 = iC39+iC3+b5-b37;
z37 = iC37+b12-iC12-iC4-v54*2+b34;
z33 = iC33+b8-b10+b9+b37;
z32 = iC32+v68-iC36+b1+b30;
z31 = iC31+v48;
z30 = iC30+v64-iC17;
z29 = b13-iC29-iC0;
z27 = iC27+b43;
z21 = iC21+b43-b4;
z20 = iC20+iC18-b1;
z19 = iC19+b10-iC22;
z16 = iC16-b8;
z10 = iC10+v48-v68;
z1 = iC1+v67-iC14;
t60 = z33/8;
t44 = (z16+z29)/8;
t43 = (z30+z21)/8;
t42 = (z19+z10)/8;
t41 = (z32-z45)/8;
t40 = (z40-z39)/8;
t39 = (z31-z27)/8;
t38 = (z31+z27)/8;
t37 = (z45+z32)/8;
t36 = (z37+z33)/8;
t35 = (z1-z20)/8;
t33 = (z19-z10)/8;
t30 = (z20+z1)/8;
t29 = (z30-z21)/8;
t28 = (z29-z16)/8;
t27 = (z37-z40-z39)/8;
t25 = t60+t44;
t23 = t41-t35;
oC6 = t36+t38;
oC12 = t38-t40;
oC13 = t38+t40;
oC14 = t60+t39;
t22 = t37+t30;
b60 = t28-t36;
oC5 = t39+t27;
oC4 = t39-t27;
b61 = t29-t33-t25;
oC7 = t37+oC12;
b62 = t42+t23-t43;
b63 = t33+t29-t22;
b64 = t42+t43-b60;
oC15 = t41+oC4;
oC11 = t35+b61;
oC0 = t23+b61;
oC9 = b60-b63;
oC2 = t40+t28+b63;
oC8 = t22+b64;
oC3 = b64-t30;
oC10 = t44-t27-b62;
oC1 = t25+b62;

C = [ oC0 oC1 oC2 oC3 ; oC4 oC5 oC6 oC7 ; oC8 oC9 oC10 oC11 ; oC12 oC13 oC14 oC15 ] ;
  end
end
end
