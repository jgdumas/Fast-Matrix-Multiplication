function C = DPS48f_mul_4_4_4(A, B, nmin, peeling, level)
NTH2ROOT2once=nthroot(2,2);
NTH2ROOT2o2=nthroot(2,2)/2;
NTH2ROOT2t2o=2/nthroot(2,2);
NTH2ROOT2t1o=1/nthroot(2,2);
NTH2ROOT2o4=nthroot(2,2)/4;
NTH2ROOT2o8=nthroot(2,2)/8;
NTH2ROOT2o16=nthroot(2,2)/16;
NTH2ROOT2o3=nthroot(2,2)/3;
NTH2ROOT2f2o3=nthroot(2,2)*2/3;

if nargin < 3, nmin = 4; end    % Threshold to conventional
if nargin < 4, peeling = 1; end % Static (1) or Dynamic (2) peeling
if nargin < 5, level = 8; end   % Verbose level
[m,k] = size(A); [k2,n] = size(B);
if (k2 ~= k), error('Incompatible matrix dimensions.'); end
% Warning size should be multiple of 4
if (k<=nmin)||(k<4)
% fprintf("#Â MM Direct: %d x %d x %d\n",m,k,n)
  C = A*B;
else
[m,n] = size(A);
m0 = 0; m1 = m;
 r0 = m0+1:m1;
n0 = 0; n1 = 1*n/47; n2 = 2*n/47; n3 = 3*n/47; n4 = 4*n/47; n5 = 5*n/47; n6 = 6*n/47; n7 = 7*n/47; n8 = 8*n/47; n9 = 9*n/47; n10 = 10*n/47; n11 = 11*n/47; n12 = 12*n/47; n13 = 13*n/47; n14 = 14*n/47; n15 = 15*n/47; n16 = 16*n/47; n17 = 17*n/47; n18 = 18*n/47; n19 = 19*n/47; n20 = 20*n/47; n21 = 21*n/47; n22 = 22*n/47; n23 = 23*n/47; n24 = 24*n/47; n25 = 25*n/47; n26 = 26*n/47; n27 = 27*n/47; n28 = 28*n/47; n29 = 29*n/47; n30 = 30*n/47; n31 = 31*n/47; n32 = 32*n/47; n33 = 33*n/47; n34 = 34*n/47; n35 = 35*n/47; n36 = 36*n/47; n37 = 37*n/47; n38 = 38*n/47; n39 = 39*n/47; n40 = 40*n/47; n41 = 41*n/47; n42 = 42*n/47; n43 = 43*n/47; n44 = 44*n/47; n45 = 45*n/47; n46 = 46*n/47; n47 = n;
 c0 = n0+1:n1; c1 = n1+1:n2; c2 = n2+1:n3; c3 = n3+1:n4; c4 = n4+1:n5; c5 = n5+1:n6; c6 = n6+1:n7; c7 = n7+1:n8; c8 = n8+1:n9; c9 = n9+1:n10; c10 = n10+1:n11; c11 = n11+1:n12; c12 = n12+1:n13; c13 = n13+1:n14; c14 = n14+1:n15; c15 = n15+1:n16; c16 = n16+1:n17; c17 = n17+1:n18; c18 = n18+1:n19; c19 = n19+1:n20; c20 = n20+1:n21; c21 = n21+1:n22; c22 = n22+1:n23; c23 = n23+1:n24; c24 = n24+1:n25; c25 = n25+1:n26; c26 = n26+1:n27; c27 = n27+1:n28; c28 = n28+1:n29; c29 = n29+1:n30; c30 = n30+1:n31; c31 = n31+1:n32; c32 = n32+1:n33; c33 = n33+1:n34; c34 = n34+1:n35; c35 = n35+1:n36; c36 = n36+1:n37; c37 = n37+1:n38; c38 = n38+1:n39; c39 = n39+1:n40; c40 = n40+1:n41; c41 = n41+1:n42; c42 = n42+1:n43; c43 = n43+1:n44; c44 = n44+1:n45; c45 = n45+1:n46; c46 = n46+1:n47;
oA19 = A(r0,c15)+A(r0,c28)*2;
oA0 = A(r0,c29);
oA1 = A(r0,c25);
oA2 = A(r0,c43);
oA3 = A(r0,c40);
oA4 = A(r0,c6);
oA5 = A(r0,c0);
oA6 = A(r0,c33);
oA7 = A(r0,c38);
oA8 = A(r0,c17);
oA9 = A(r0,c1);
oA10 = A(r0,c15);
oA11 = A(r0,c20);
oA12 = A(r0,c21);
oA13 = A(r0,c4);
oA14 = A(r0,c26);
oA15 = A(r0,c41);
oA16 = A(r0,c39);
oA17 = A(r0,c11);
oA18 = A(r0,c18);
oA20 = A(r0,c14);
oA21 = A(r0,c16);
oA22 = A(r0,c13);
oA23 = A(r0,c24);
oA24 = A(r0,c32);
oA25 = A(r0,c30);
oA26 = A(r0,c44);
oA27 = A(r0,c35);
oA28 = A(r0,c27);
oA29 = A(r0,c37);
oA30 = A(r0,c10);
oA31 = A(r0,c28);
oA32 = A(r0,c23);
oA33 = A(r0,c7);
oA34 = A(r0,c22);
oA35 = A(r0,c8);
oA36 = A(r0,c12);
oA37 = A(r0,c46);
oA38 = A(r0,c34);
oA39 = A(r0,c3);
oA40 = A(r0,c2);
oA41 = A(r0,c45);
oA42 = A(r0,c5);
oA43 = A(r0,c42);
oA44 = A(r0,c31);
oA45 = A(r0,c36);
oA46 = A(r0,c9);
oA47 = A(r0,c19);

[m,n] = size(B);
m0 = 0; m1 = 1*m/47; m2 = 2*m/47; m3 = 3*m/47; m4 = 4*m/47; m5 = 5*m/47; m6 = 6*m/47; m7 = 7*m/47; m8 = 8*m/47; m9 = 9*m/47; m10 = 10*m/47; m11 = 11*m/47; m12 = 12*m/47; m13 = 13*m/47; m14 = 14*m/47; m15 = 15*m/47; m16 = 16*m/47; m17 = 17*m/47; m18 = 18*m/47; m19 = 19*m/47; m20 = 20*m/47; m21 = 21*m/47; m22 = 22*m/47; m23 = 23*m/47; m24 = 24*m/47; m25 = 25*m/47; m26 = 26*m/47; m27 = 27*m/47; m28 = 28*m/47; m29 = 29*m/47; m30 = 30*m/47; m31 = 31*m/47; m32 = 32*m/47; m33 = 33*m/47; m34 = 34*m/47; m35 = 35*m/47; m36 = 36*m/47; m37 = 37*m/47; m38 = 38*m/47; m39 = 39*m/47; m40 = 40*m/47; m41 = 41*m/47; m42 = 42*m/47; m43 = 43*m/47; m44 = 44*m/47; m45 = 45*m/47; m46 = 46*m/47; m47 = m;
 r0 = m0+1:m1; r1 = m1+1:m2; r2 = m2+1:m3; r3 = m3+1:m4; r4 = m4+1:m5; r5 = m5+1:m6; r6 = m6+1:m7; r7 = m7+1:m8; r8 = m8+1:m9; r9 = m9+1:m10; r10 = m10+1:m11; r11 = m11+1:m12; r12 = m12+1:m13; r13 = m13+1:m14; r14 = m14+1:m15; r15 = m15+1:m16; r16 = m16+1:m17; r17 = m17+1:m18; r18 = m18+1:m19; r19 = m19+1:m20; r20 = m20+1:m21; r21 = m21+1:m22; r22 = m22+1:m23; r23 = m23+1:m24; r24 = m24+1:m25; r25 = m25+1:m26; r26 = m26+1:m27; r27 = m27+1:m28; r28 = m28+1:m29; r29 = m29+1:m30; r30 = m30+1:m31; r31 = m31+1:m32; r32 = m32+1:m33; r33 = m33+1:m34; r34 = m34+1:m35; r35 = m35+1:m36; r36 = m36+1:m37; r37 = m37+1:m38; r38 = m38+1:m39; r39 = m39+1:m40; r40 = m40+1:m41; r41 = m41+1:m42; r42 = m42+1:m43; r43 = m43+1:m44; r44 = m44+1:m45; r45 = m45+1:m46; r46 = m46+1:m47;
n0 = 0; n1 = n;
 c0 = n0+1:n1;
oB11 = B(r18,c0)+B(r29,c0)-B(r1,c0);
oB0 = B(r25,c0);
oB1 = B(r36,c0);
oB2 = B(r28,c0);
oB3 = B(r18,c0);
oB4 = B(r21,c0);
oB5 = B(r35,c0);
oB6 = B(r15,c0);
oB7 = B(r23,c0);
oB8 = B(r22,c0);
oB9 = B(r7,c0);
oB10 = B(r4,c0);
oB12 = B(r31,c0);
oB13 = B(r10,c0);
oB14 = B(r45,c0);
oB15 = B(r6,c0);
oB16 = B(r46,c0);
oB17 = B(r5,c0);
oB18 = B(r17,c0);
oB19 = B(r24,c0);
oB20 = B(r19,c0);
oB21 = B(r26,c0);
oB22 = B(r39,c0);
oB23 = B(r11,c0);
oB24 = B(r34,c0);
oB25 = B(r3,c0);
oB26 = B(r32,c0);
oB27 = B(r9,c0);
oB28 = B(r13,c0);
oB29 = B(r38,c0);
oB30 = B(r12,c0);
oB31 = B(r29,c0);
oB32 = B(r2,c0);
oB33 = B(r40,c0);
oB34 = B(r16,c0);
oB35 = B(r14,c0);
oB36 = B(r41,c0);
oB37 = B(r27,c0);
oB38 = B(r43,c0);
oB39 = B(r1,c0);
oB40 = B(r30,c0);
oB41 = B(r42,c0);
oB42 = B(r0,c0);
oB43 = B(r33,c0);
oB44 = B(r8,c0);
oB45 = B(r44,c0);
oB46 = B(r20,c0);
oB47 = B(r37,c0);

iC0 = DPS48f_mul( oA0, oB0, nmin, peeling, level);
iC1 = DPS48f_mul( oA1, oB1, nmin, peeling, level);
iC2 = DPS48f_mul( oA2, oB2, nmin, peeling, level);
iC3 = DPS48f_mul( oA3, oB3, nmin, peeling, level);
iC4 = DPS48f_mul( oA4, oB4, nmin, peeling, level);
iC5 = DPS48f_mul( oA5, oB5, nmin, peeling, level);
iC6 = DPS48f_mul( oA6, oB6, nmin, peeling, level);
iC7 = DPS48f_mul( oA7, oB7, nmin, peeling, level);
iC8 = DPS48f_mul( oA8, oB8, nmin, peeling, level);
iC9 = DPS48f_mul( oA9, oB9, nmin, peeling, level);
iC10 = DPS48f_mul( oA10, oB10, nmin, peeling, level);
iC11 = DPS48f_mul( oA11, oB11, nmin, peeling, level);
iC12 = DPS48f_mul( oA12, oB12, nmin, peeling, level);
iC13 = DPS48f_mul( oA13, oB13, nmin, peeling, level);
iC14 = DPS48f_mul( oA14, oB14, nmin, peeling, level);
iC15 = DPS48f_mul( oA15, oB15, nmin, peeling, level);
iC16 = DPS48f_mul( oA16, oB16, nmin, peeling, level);
iC17 = DPS48f_mul( oA17, oB17, nmin, peeling, level);
iC18 = DPS48f_mul( oA18, oB18, nmin, peeling, level);
iC19 = DPS48f_mul( oA19, oB19, nmin, peeling, level);
iC20 = DPS48f_mul( oA20, oB20, nmin, peeling, level);
iC21 = DPS48f_mul( oA21, oB21, nmin, peeling, level);
iC22 = DPS48f_mul( oA22, oB22, nmin, peeling, level);
iC23 = DPS48f_mul( oA23, oB23, nmin, peeling, level);
iC24 = DPS48f_mul( oA24, oB24, nmin, peeling, level);
iC25 = DPS48f_mul( oA25, oB25, nmin, peeling, level);
iC26 = DPS48f_mul( oA26, oB26, nmin, peeling, level);
iC27 = DPS48f_mul( oA27, oB27, nmin, peeling, level);
iC28 = DPS48f_mul( oA28, oB28, nmin, peeling, level);
iC29 = DPS48f_mul( oA29, oB29, nmin, peeling, level);
iC30 = DPS48f_mul( oA30, oB30, nmin, peeling, level);
iC31 = DPS48f_mul( oA31, oB31, nmin, peeling, level);
iC32 = DPS48f_mul( oA32, oB32, nmin, peeling, level);
iC33 = DPS48f_mul( oA33, oB33, nmin, peeling, level);
iC34 = DPS48f_mul( oA34, oB34, nmin, peeling, level);
iC35 = DPS48f_mul( oA35, oB35, nmin, peeling, level);
iC36 = DPS48f_mul( oA36, oB36, nmin, peeling, level);
iC37 = DPS48f_mul( oA37, oB37, nmin, peeling, level);
iC38 = DPS48f_mul( oA38, oB38, nmin, peeling, level);
iC39 = DPS48f_mul( oA39, oB39, nmin, peeling, level);
iC40 = DPS48f_mul( oA40, oB40, nmin, peeling, level);
iC41 = DPS48f_mul( oA41, oB41, nmin, peeling, level);
iC42 = DPS48f_mul( oA42, oB42, nmin, peeling, level);
iC43 = DPS48f_mul( oA43, oB43, nmin, peeling, level);
iC44 = DPS48f_mul( oA44, oB44, nmin, peeling, level);
iC45 = DPS48f_mul( oA45, oB45, nmin, peeling, level);
iC46 = DPS48f_mul( oA46, oB46, nmin, peeling, level);
iC47 = DPS48f_mul( oA47, oB47, nmin, peeling, level);
t47 = iC31*2;
oC13 = iC39+iC31;
oC24 = iC1-t47;
oC22 = iC10+t47;
oC0 = iC34;
oC1 = iC21;
oC2 = iC20;
oC3 = iC37;
oC4 = iC40;
oC5 = iC36;
oC6 = iC32;
oC7 = iC26;
oC8 = iC33;
oC9 = iC13;
oC10 = iC41;
oC11 = iC3;
oC12 = iC28;
oC14 = iC12;
oC15 = iC38;
oC16 = iC7;
oC17 = iC46;
oC18 = iC35;
oC19 = iC17;
oC20 = iC47;
oC21 = iC8;
oC23 = iC4;
oC25 = iC0;
oC26 = iC30;
oC27 = iC23;
oC28 = iC19;
oC29 = iC24;
oC30 = iC11;
oC31 = iC25;
oC32 = iC45;
oC33 = iC16;
oC34 = iC15;
oC35 = iC6;
oC36 = iC42;
oC37 = iC29;
oC38 = iC22;
oC39 = iC2;
oC40 = iC18;
oC41 = iC9;
oC42 = iC14;
oC43 = iC27;
oC44 = iC5;
oC45 = iC44;
oC46 = iC43;

C = [ oC0 oC1 oC2 oC3 oC4 oC5 oC6 oC7 oC8 oC9 oC10 oC11 oC12 oC13 oC14 oC15 oC16 oC17 oC18 oC19 oC20 oC21 oC22 oC23 oC24 oC25 oC26 oC27 oC28 oC29 oC30 oC31 oC32 oC33 oC34 oC35 oC36 oC37 oC38 oC39 oC40 oC41 oC42 oC43 oC44 oC45 oC46 ] ;
end
