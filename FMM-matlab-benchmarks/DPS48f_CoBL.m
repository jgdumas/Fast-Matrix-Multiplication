function M = DPS48f_CoBL(A, nmin, peeling, level)
NTH2ROOT2once=nthroot(2,2);
NTH2ROOT2o2=nthroot(2,2)/2;
NTH2ROOT2t2o=2/nthroot(2,2);
NTH2ROOT2t1o=1/nthroot(2,2);
NTH2ROOT2o4=nthroot(2,2)/4;
NTH2ROOT2o8=nthroot(2,2)/8;
NTH2ROOT2o16=nthroot(2,2)/16;
NTH2ROOT2o3=nthroot(2,2)/3;
NTH2ROOT2f2o3=nthroot(2,2)*2/3;

  if nargin < 2, nmin = 4; end    % Threshold to conventional
  if nargin < 3, peeling = 1; end % Static (1) or Dynamic (2) peeling
  if nargin < 4, level = 8; end   % Verbose level
[m,n] = size(A);
if (m<=nmin)||(n<=nmin)||(m<4)||(n<4)
   M=A;
else
[m,n] = size(A);
m0 = 0; m1 = 1*m/4; m2 = 2*m/4; m3 = 3*m/4; m4 = m;
 r0 = m0+1:m1; r1 = m1+1:m2; r2 = m2+1:m3; r3 = m3+1:m4;
n0 = 0; n1 = 1*n/4; n2 = 2*n/4; n3 = 3*n/4; n4 = n;
 c0 = n0+1:n1; c1 = n1+1:n2; c2 = n2+1:n3; c3 = n3+1:n4;
tA0 = A(r0,c0);
tA1 = A(r0,c1);
tA2 = A(r0,c2);
tA3 = A(r0,c3);
tA4 = A(r1,c0);
tA5 = A(r1,c1);
tA6 = A(r1,c2);
tA7 = A(r1,c3);
tA8 = A(r2,c0);
tA9 = A(r2,c1);
tA10 = A(r2,c2);
tA11 = A(r2,c3);
tA12 = A(r3,c0);
tA13 = A(r3,c1);
tA14 = A(r3,c2);
tA15 = A(r3,c3);


iM0 = DPS48f_CoBL( tA0, nmin, peeling, level);
iM1 = DPS48f_CoBL( tA1, nmin, peeling, level);
iM2 = DPS48f_CoBL( tA2, nmin, peeling, level);
iM3 = DPS48f_CoBL( tA3, nmin, peeling, level);
iM4 = DPS48f_CoBL( tA4, nmin, peeling, level);
iM5 = DPS48f_CoBL( tA5, nmin, peeling, level);
iM6 = DPS48f_CoBL( tA6, nmin, peeling, level);
iM7 = DPS48f_CoBL( tA7, nmin, peeling, level);
iM8 = DPS48f_CoBL( tA8, nmin, peeling, level);
iM9 = DPS48f_CoBL( tA9, nmin, peeling, level);
iM10 = DPS48f_CoBL( tA10, nmin, peeling, level);
iM11 = DPS48f_CoBL( tA11, nmin, peeling, level);
iM12 = DPS48f_CoBL( tA12, nmin, peeling, level);
iM13 = DPS48f_CoBL( tA13, nmin, peeling, level);
iM14 = DPS48f_CoBL( tA14, nmin, peeling, level);
iM15 = DPS48f_CoBL( tA15, nmin, peeling, level);
t16 = iM1+iM8;
t17 = iM7+iM14;
t18 = iM11-iM13;
t19 = iM2+iM4;
t20 = iM3-iM10;
t21 = iM0+iM9;
t22 = iM5+iM12;
t23 = iM3+iM10;
t24 = iM6+iM15;
t25 = iM5-iM12;
t26 = t16-t17;
t27 = t16+t17;
t28 = t18-t19;
t29 = t18+t19;
t30 = iM11+iM13;
t31 = iM7-iM14;
t33 = t24+t21;
t34 = iM15-t21-iM6;
t35 = iM2-iM4;
t36 = t24-t21;
t38 = iM1-iM8;
t39 = t24+iM0-iM9;
t40 = t23+t29;
t41 = t22+t28;
t42 = t22-t28;
t43 = t23+t22;
t44 = t23-t22;
t45 = t20-t25;
t46 = t20+t25;
t47 = t23-t29;
t48 = t35+t36;
t49 = t16+t34;
t50 = t35-t36;
t51 = t38-t39;
t52 = t19+t33;
t53 = t16-t34;
t54 = t19-t33;
oM35 = t45-t26;
oM39 = t27+t43;
oM40 = t26-t44;
oM42 = t20+t41;
t59 = t26+t45;
oM16 = t42-t20;
oM22 = t27+t46;
t62 = t26+t44;
t63 = t38+t39;
oM20 = t40-t25;
oM46 = t25+t40;
oM19 = t20+t42;
oM18 = t20-t41;
t68 = t25+t47;
oM7 = t27-t43;
oM17 = t27-t46;
oM28 = t47-t25;
t72 = t31-t49;
t73 = t30-t54;
t74 = t31+t49;
t75 = t31-t53;
t76 = t18+t50;
t77 = t17+t63;
t78 = t18-t50;
t79 = t31+t53;
t80 = t52-t30;
t81 = t30+t52;
t82 = t17+t51;
t83 = t30+t54;
t84 = t18+t48;
t85 = t18-t48;
t86 = t17-t51;
oM0 = oM18-t72;
oM1 = -oM42-t82;
oM2 = t86+oM20;
oM3 = -t62;
oM4 = oM40+t84;
oM5 = -t68-t74;
oM6 = t59+t73;
oM8 = oM16-t75;
oM9 = t81-oM39;
oM10 = -t62-t76;
oM11 = oM18+t72;
oM12 = oM46+t79;
oM13 = oM46-t79;
oM14 = oM7+t83;
oM15 = t17-t63-oM28;
oM21 = oM42-t82;
oM23 = t73-t59;
oM24 = oM17-t78;
oM25 = t62-t76;
oM26 = -t68;
oM27 = oM17+t78;
oM29 = oM35+t80;
oM30 = t80-oM35;
oM31 = oM22-t85;
oM32 = -t59;
oM33 = oM19-t77;
oM34 = oM19+t77;
oM36 = oM22+t85;
oM37 = oM40-t84;
oM38 = t75+oM16;
oM41 = t86-oM20;
oM43 = t68-t74;
oM44 = oM39+t81;
oM45 = oM7-t83;

M = [ oM0 oM1 oM2 oM3 oM4 oM5 oM6 oM7 oM8 oM9 oM10 oM11 oM12 oM13 oM14 oM15 oM16 oM17 oM18 oM19 oM20 oM21 oM22 oM23 oM24 oM25 oM26 oM27 oM28 oM29 oM30 oM31 oM32 oM33 oM34 oM35 oM36 oM37 oM38 oM39 oM40 oM41 oM42 oM43 oM44 oM45 oM46 ] ;
end
